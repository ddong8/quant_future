<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>移动端菜单修复测试</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 16px;
        }
        
        .container {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            max-width: 500px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 24px;
        }
        
        .title {
            font-size: 22px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .subtitle {
            font-size: 14px;
            color: #7f8c8d;
        }
        
        .fix-status {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .fix-status h3 {
            margin: 0 0 8px 0;
            color: #155724;
            font-size: 16px;
        }
        
        .fix-status p {
            margin: 0;
            color: #155724;
            font-size: 13px;
        }
        
        .problem-section {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 20px;
        }
        
        .problem-section h4 {
            margin: 0 0 12px 0;
            color: #721c24;
            font-size: 15px;
        }
        
        .problem-section p {
            margin: 0 0 8px 0;
            color: #721c24;
            font-size: 13px;
            line-height: 1.4;
        }
        
        .solution-section {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 20px;
        }
        
        .solution-section h4 {
            margin: 0 0 12px 0;
            color: #0c5460;
            font-size: 15px;
        }
        
        .solution-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .solution-list li {
            padding: 6px 0;
            font-size: 13px;
            color: #0c5460;
            border-bottom: 1px solid #bee5eb;
            line-height: 1.4;
        }
        
        .solution-list li:last-child {
            border-bottom: none;
        }
        
        .solution-list li::before {
            content: "✓ ";
            color: #28a745;
            font-weight: bold;
            margin-right: 8px;
        }
        
        .test-section {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 20px;
        }
        
        .test-section h4 {
            margin: 0 0 12px 0;
            color: #856404;
            font-size: 15px;
        }
        
        .test-steps {
            list-style: decimal;
            padding-left: 20px;
            margin: 0;
        }
        
        .test-steps li {
            margin: 8px 0;
            font-size: 13px;
            color: #856404;
            line-height: 1.4;
        }
        
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 20px 0;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .btn.secondary {
            background: #6c757d;
        }
        
        .btn.success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .result {
            margin-top: 16px;
            padding: 12px;
            border-radius: 6px;
            font-size: 13px;
            display: none;
        }
        
        .result.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .result.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .result.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .device-info {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
            margin-top: 16px;
            border: 1px solid #dee2e6;
        }
        
        .device-info h5 {
            margin: 0 0 8px 0;
            font-size: 14px;
            color: #495057;
        }
        
        .device-info p {
            margin: 4px 0;
            font-size: 12px;
            color: #6c757d;
        }
        
        /* 屏幕尺寸指示器 */
        .screen-indicator {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-family: monospace;
            z-index: 9999;
        }
        
        @media (max-width: 480px) {
            body {
                padding: 12px;
            }
            
            .container {
                padding: 16px;
            }
            
            .title {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="screen-indicator" id="screenIndicator">
        Loading...
    </div>
    
    <div class="container">
        <div class="header">
            <h1 class="title">🔧 移动端菜单修复测试</h1>
            <p class="subtitle">验证左侧菜单在手机端的折叠行为</p>
        </div>
        
        <div class="fix-status">
            <h3>✅ 修复完成</h3>
            <p>移动端左侧菜单现在默认折叠，点击菜单按钮可以滑出</p>
        </div>
        
        <div class="problem-section">
            <h4>❌ 原始问题</h4>
            <p><strong>用户反馈：</strong>"移动端体验还是不好，手机端左侧菜单默认不会折叠"</p>
            <p><strong>具体表现：</strong></p>
            <p>• 手机访问时左侧菜单占用大量屏幕空间</p>
            <p>• 菜单没有根据屏幕尺寸自动调整状态</p>
            <p>• 影响主要内容的显示和操作</p>
        </div>
        
        <div class="solution-section">
            <h4>✅ 修复方案</h4>
            <ul class="solution-list">
                <li>添加移动端检测函数 isMobile()</li>
                <li>组件初始化时自动设置移动端状态</li>
                <li>移动端默认折叠侧边栏 (sidebarCollapsed = true)</li>
                <li>移动端菜单默认关闭 (mobileMenuOpen = false)</li>
                <li>窗口大小变化时智能调整状态</li>
                <li>点击菜单项后自动关闭移动端菜单</li>
                <li>CSS确保移动端侧边栏默认隐藏</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h4>🧪 测试步骤</h4>
            <ol class="test-steps">
                <li>点击"打开交易平台"按钮</li>
                <li>使用 admin/admin123 登录系统</li>
                <li>观察左侧菜单是否默认隐藏</li>
                <li>点击左上角菜单按钮（☰）</li>
                <li>验证菜单是否从左侧滑出</li>
                <li>点击菜单项测试是否自动关闭</li>
                <li>点击遮罩层测试是否关闭菜单</li>
                <li>调整浏览器窗口大小测试响应式</li>
            </ol>
        </div>
        
        <div class="action-buttons">
            <button class="btn" onclick="openTradingPlatform()">
                🌐 打开交易平台
            </button>
            <button class="btn secondary" onclick="showDeviceInfo()">
                📱 显示设备信息
            </button>
            <button class="btn success" onclick="runMenuTest()">
                🧪 运行菜单测试
            </button>
        </div>
        
        <div id="result" class="result"></div>
        
        <div id="deviceInfo" class="device-info" style="display: none;">
            <h5>📱 当前设备信息</h5>
            <p id="screenSize">屏幕尺寸: -</p>
            <p id="deviceType">设备类型: -</p>
            <p id="isMobileDevice">是否移动端: -</p>
            <p id="touchSupport">触摸支持: -</p>
        </div>
    </div>
    
    <script>
        let testWindow = null;
        
        // 更新屏幕指示器
        function updateScreenIndicator() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            let deviceType = '';
            
            if (width <= 360) {
                deviceType = '小屏手机';
            } else if (width <= 480) {
                deviceType = '手机';
            } else if (width <= 768) {
                deviceType = '大屏手机/平板';
            } else if (width <= 1024) {
                deviceType = '平板';
            } else {
                deviceType = '桌面';
            }
            
            document.getElementById('screenIndicator').textContent = `${width}×${height} (${deviceType})`;
        }
        
        function openTradingPlatform() {
            testWindow = window.open('http://localhost:3000', 'trading_platform');
            if (testWindow) {
                showResult('success', '✅ 交易平台已打开！请按照测试步骤验证移动端菜单行为：\n\n1. 登录后观察左侧菜单是否默认隐藏\n2. 点击菜单按钮测试滑出效果\n3. 点击菜单项测试自动关闭功能');
            } else {
                showResult('error', '❌ 无法打开新窗口，请手动访问: http://localhost:3000');
            }
        }
        
        function showDeviceInfo() {
            const deviceInfoDiv = document.getElementById('deviceInfo');
            const width = window.innerWidth;
            const height = window.innerHeight;
            const isMobile = width <= 768;
            const hasTouch = 'ontouchstart' in window;
            
            let deviceType = '';
            if (width <= 360) {
                deviceType = '小屏手机';
            } else if (width <= 480) {
                deviceType = '手机';
            } else if (width <= 768) {
                deviceType = '大屏手机/平板';
            } else if (width <= 1024) {
                deviceType = '平板';
            } else {
                deviceType = '桌面';
            }
            
            document.getElementById('screenSize').textContent = `屏幕尺寸: ${width}×${height}px`;
            document.getElementById('deviceType').textContent = `设备类型: ${deviceType}`;
            document.getElementById('isMobileDevice').textContent = `是否移动端: ${isMobile ? '是 (≤768px)' : '否 (>768px)'}`;
            document.getElementById('touchSupport').textContent = `触摸支持: ${hasTouch ? '支持' : '不支持'}`;
            
            if (deviceInfoDiv.style.display === 'none') {
                deviceInfoDiv.style.display = 'block';
                showResult('info', '📱 设备信息已显示。根据当前屏幕尺寸，菜单应该' + (isMobile ? '默认隐藏' : '正常显示') + '。');
            } else {
                deviceInfoDiv.style.display = 'none';
            }
        }
        
        function runMenuTest() {
            const width = window.innerWidth;
            const isMobile = width <= 768;
            
            showResult('info', '🧪 开始菜单测试...');
            
            const tests = [
                '检测当前设备类型...',
                '验证移动端判断逻辑...',
                '检查菜单默认状态...',
                '测试菜单交互行为...',
                '验证响应式切换...'
            ];
            
            let currentTest = 0;
            const interval = setInterval(() => {
                if (currentTest < tests.length) {
                    showResult('info', `🧪 ${tests[currentTest]}`);
                    currentTest++;
                } else {
                    clearInterval(interval);
                    
                    // 生成测试报告
                    let report = '📊 移动端菜单测试报告：\n\n';
                    report += `当前屏幕: ${width}×${window.innerHeight}px\n`;
                    report += `设备判断: ${isMobile ? '移动端' : '桌面端'}\n`;
                    report += `预期行为: 菜单应该${isMobile ? '默认隐藏' : '正常显示'}\n\n`;
                    
                    if (isMobile) {
                        report += '✅ 移动端修复验证：\n';
                        report += '• 菜单应该默认隐藏（不占用屏幕空间）\n';
                        report += '• 点击菜单按钮应该从左侧滑出\n';
                        report += '• 点击菜单项应该自动关闭菜单\n';
                        report += '• 点击遮罩层应该关闭菜单\n\n';
                        report += '请打开交易平台验证这些行为是否正常！';
                    } else {
                        report += '💡 当前为桌面环境：\n';
                        report += '• 菜单应该正常显示在左侧\n';
                        report += '• 可以通过菜单按钮折叠/展开\n';
                        report += '• 建议调整浏览器窗口到768px以下测试移动端效果\n';
                        report += '• 或使用开发者工具的设备模拟功能';
                    }
                    
                    showResult('success', report);
                }
            }, 800);
        }
        
        function showResult(type, message) {
            const resultDiv = document.getElementById('result');
            resultDiv.className = `result ${type}`;
            resultDiv.style.display = 'block';
            resultDiv.textContent = message;
            
            // 滚动到结果区域
            resultDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        // 监听窗口大小变化
        window.addEventListener('resize', updateScreenIndicator);
        
        // 页面加载时初始化
        window.addEventListener('load', () => {
            updateScreenIndicator();
            
            const width = window.innerWidth;
            const isMobile = width <= 768;
            
            showResult('info', `📱 移动端菜单修复测试已加载。\n\n当前屏幕: ${width}px ${isMobile ? '(移动端)' : '(桌面端)'}\n预期: 菜单应该${isMobile ? '默认隐藏' : '正常显示'}`);
        });
        
        // 监听设备方向变化
        window.addEventListener('orientationchange', () => {
            setTimeout(updateScreenIndicator, 100);
        });
    </script>
</body>
</html>